# Unicode的支持

我之前说：要想在一定时间内掌握Unicode这个技术规范，大部分情况下是不可能的。最近review了一下LuaTeX和XeTeX中的Unicode支持，觉得这两个引擎对于Unicode的支持其实也有一些小毛病。

常言道：谁能无错？所以想要杜绝错误和问题是很难的。这句话的原典是拉丁文谚语，完整版其实是：errare humanum est, perseverare autem diabolicum。这后半句的意思呢，就是：坚持错误就蠢透的。

经过一些内部人士的消息，我们可以知道，即是是某些技术标准委员会的成员也并不是能够把Unicode的细节理解得很清楚。

甚至，我对于Unicode的态度是不太恭敬的。毕竟Unicode不是宇宙真理，它并不会表现出唯一性来。真的搞了排版软件之后，就会明白，encoding这种东西，是一种数的技术。它还不是代数。总体观之，是围绕着数的一种规则集合。如此定义，就会从替代Unicode的角度上来思考。从而脱离单一技术框架，进而综合出一些普遍性的东西来。

不搞排版软件呢，就容易看个热闹，容易脑子看懂了，手搞不懂。这种情况很常见。不做题就不知道你会不会这个题。但悲剧性的就是，没有习题集。但听说某友正在写一本有习题的书。这可太好了，起码有折磨人的新玩具了（不是）。

我呢，在写一本新书。算是对自己过去的知识告别，进而开启一个新的阶段。这不是一个新领域的开辟之作。更多地是该领域的总结。但我需要讲的是，此书的Unicode部分就是按照“数的规则集合”来写的。

回到对于支持Unicode的TeX的review上来。这俩TeX对于Unicode要么是codepoint层面的，要么就是span层面的。这个span层面，可能对应的是Unicode中的Grapheme Cluster，但也有可能是Cluster of Grapheme Cluster。这东西的支持实际上往往要依赖于ICU和Harfbuzz。这是好事么？是，用户不需要再如Omega引擎那样，手写处理过程了（实际上社区最后写出来的OTP并不多）。但不好在哪？Unicode处理和TeX中的node结合的不是很好。控制度很低。而且速度还比较慢。

那能怎么办？我每天都可能会学到以前没有掌握过的Unicode的知识。所以不完备大概是一个大概率事件。做人不要有弥赛亚情节，麻烦省一半。
